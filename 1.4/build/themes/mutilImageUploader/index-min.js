KISSY.add(function(f,g,i){function e(a){e.superclass.constructor.call(this,a)}var c=g.all;f.extend(e,i,{render:function(){var a=this;e.superclass.render.call(a);var b=a.get("uploader");b.on("remove",function(){a._changeText()});b.on("success",function(){a._changeText()});b=b.get("target").text();a.set("defaultText",b)},_addHandler:function(a){var a=a.file,b=a.id,d=c(".J_Del_"+b);d.data("data-file",a);d.on("click",this._delHandler,this);a=c(".J_Pic_"+b);a.show();this.preview(a)},_errorHandler:function(a){var b=
this,d=a.msg,a=a.file;f.log(d);if(!a)return!1;var e=a.id;c(".J_ErrorMsg_"+e).html("\u4e0a\u4f20\u5931\u8d25");f.later(function(){alert(d);b.get("uploader").get("queue").remove(e)},1E3)},_changeText:function(){var a=this.get("uploader"),b=this.getFilesLen(),d=a.get("target").children("span"),c=this.get("maxText"),e=this.get("defaultText"),a=a.get("max");Number(a)<=b?d.text(f.substitute(c,{max:a})):d.text(e)}},{ATTRS:{name:{value:"refundUploader"},use:{value:"proBars,filedrop,preview,imageZoom"},fileTpl:{value:'<li id="queue-file-{id}" class="g-u" data-name="{name}"><div class="pic-wrapper"><div class="pic"><span><img class="J_Pic_{id} preview-img" src="" /></span></div><div class=" J_Mask_{id} pic-mask"></div><div class="status-wrapper J_FileStatus"><div class="status waiting-status"><p>\u7b49\u5f85\u4e0a\u4f20</p></div><div class="status start-status progress-status success-status"><div class="J_ProgressBar_{id}">\u4e0a\u4f20\u4e2d...</div></div><div class="status error-status"><p class="J_ErrorMsg_{id}">\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01</p></div></div></div><div><a class="J_Del_{id} del-pic" href="#">\u5220\u9664</a></div></li>'},
defaultText:{value:""},maxText:{value:"\u60a8\u5df2\u4e0a\u4f20\u6ee1{max}\u5f20\u56fe\u7247"}}});return e},{requires:["node","gallery/uploader/1.4/themes/imageUploader/index"]});
KISSY.add(function(f,g,i){function e(a){e.superclass.constructor.call(this,a)}var c=g.all;f.extend(e,i,{render:function(){var a=this;e.superclass.render.call(a);var b=a.get("uploader");b.on("remove",function(){a._changeText()});b.on("success",function(){a._changeText()});b=b.get("target").text();a.set("defaultText",b)},_addHandler:function(a){var a=a.file,b=a.id,d=c(".J_Del_"+b);d.data("data-file",a);d.on("click",this._delHandler,this);a=c(".J_Pic_"+b);a.show();this.preview(a)},_progressHandler:function(a){var b=
Math.ceil(100*a.loaded/a.total),a=c("#queue-file-"+a.file.id);c(".current-progress",a).html(b+"%");c(".progress-bar",a).css("border","1px solid #336699")},_successHandler:function(a){var b=a.file.id,d=c("#queue-file-"+b),e=a.result,h=this.get("uploader"),g=h.getPlugin("auth");e.status?(c(".J_ZoomPic",d).attr("data-zoom-img",a.file.sUrl),c(".file-preview",d).removeClass("hidden"),c(".current-progress",d).html("100%").addClass("complete").removeClass("progress"),h=this.get("uploader"),a=h.get("queue").getFiles("success").length,
c("#J_UploadNum").html("\u5df2\u4e0a\u4f20"+a+"\u5f20\uff0c\u8fd8\u53ef\u4ee5\u4e0a\u4f20"+(g.get("max")-a)+"\u5f20")):(c(".current-progress",d).html("0%").removeClass("complete").removeClass("progress"),c(".progress-bar",d).css("border","1px solid #ccc"));d=h.get("queue");f.each(d.get("files"),function(a,c){a.id===b&&c==d.get("files").length-2&&f.later(function(){g._maxStopUpload()},1E3)})},_errorHandler:function(a){var b=a.msg||a.result.msg;c(".J_ErrorMsg_"+a.file.id).html(b)},_changeText:function(){var a=this.get("uploader"),b=this.getFilesLen(),d=
a.get("target").children("span"),c=this.get("maxText"),e=this.get("defaultText"),a=a.get("max");Number(a)<=b?d.text(f.substitute(c,{max:a})):d.text(e)}},{ATTRS:{name:{value:"refundUploader"},use:{value:"proBars,filedrop,preview,imageZoom"},defaultText:{value:"\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247"},maxText:{value:"\u60a8\u5df2\u4e0a\u4f20\u6ee1{max}\u5f20\u56fe\u7247"}}});return e},{requires:["node","gallery/uploader/1.4/themes/imageUploader/index"]});
